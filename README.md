# Motor Land

Интернет-магазин контрактных двигателей и КПП в Алматы, Казахстан.

## Описание

Motor Land — веб-сайт компании, специализирующейся на поставке контрактных двигателей и коробок передач для автомобилей из Малайзии. Проект представляет собой полнофункциональный интернет-магазин с собственной CMS-системой, каталогом товаров с фильтрацией, системой управления контентом, SEO-оптимизацией и интеграцией с аналитикой.

### Основные возможности

- Каталог товаров с фильтрацией по марке, модели и году выпуска
- Детальные страницы товаров с описанием и характеристиками
- Система управления контентом (CMS) для редактирования страниц
- SEO-оптимизация: мета-теги, Schema.org разметка, sitemap, ЧПУ URL
- Формы обратной связи с защитой от спама
- Страницы: акции, контакты, гарантии, оплата/доставка, автосервис
- Адаптивный дизайн для мобильных устройств
- Интеграция с Google Analytics
- Автоматическая оптимизация изображений (WebP)

## Технологии

- **Backend:** PHP 7.4+
- **База данных:** MySQL 5.7+ (mysqli)
- **Frontend:** HTML5, CSS3, JavaScript (jQuery)
- **CMS:** Собственная система управления контентом Hyst
- **Библиотеки:**
  - jQuery 3.x
  - jQuery UI
  - CKEditor (административная панель)
  - Revealator (анимации)
- **SEO:** Schema.org, Open Graph, Twitter Cards, XML Sitemap

## Структура проекта

```
motor-land.kz/
├── hyst/                          # Система управления контентом (CMS)
│   ├── config.php                 # Конфигурация БД и настроек
│   ├── php.php                    # Инициализация системы
│   ├── head.php                   # Head секция админки
│   ├── sbody.php                  # Начало body админки
│   ├── fbody.php                  # Конец body админки
│   ├── core/                      # Ядро CMS
│   │   ├── functions.php          # Основные функции (транслит, оптимизация изображений)
│   │   ├── constants.php          # Константы и регулярные выражения
│   │   ├── setups.php             # Настройки и инициализация таблиц
│   │   ├── html.php               # HTML-шаблоны админки
│   │   └── admin_profile.php      # Профили администраторов
│   ├── mods/                      # Модули CMS
│   │   ├── online_store/          # Модуль интернет-магазина
│   │   ├── sliders/               # Модуль слайдеров
│   │   ├── simple_texts/          # Модуль простых текстов
│   │   ├── simple_images/         # Модуль изображений
│   │   ├── customtexts/           # Модуль пользовательских текстов
│   │   ├── page_content/          # Модуль управления контентом страниц
│   │   └── seo_queries/           # Модуль SEO-запросов
│   └── visual/                    # Стили и скрипты админки
├── des/                           # Дизайн-компоненты сайта
│   ├── head.php                   # Шапка сайта
│   ├── foter.php                  # Подвал сайта
│   ├── menu.php                   # Меню навигации
│   ├── myjs.js                    # JavaScript для фронтенда
│   ├── jq.js                      # jQuery
│   └── fm.revealator.jquery.js    # Revealator библиотека
├── img/                           # Статические изображения сайта
├── cms_img/                       # Изображения контента (загруженные через CMS)
│   ├── 2024-12/                   # Организация по датам
│   ├── 2025-01/
│   └── 2025-02/
├── index.php                      # Главная страница
├── catalog.php                    # Страница каталога товаров
├── detal.php                      # Страница детального просмотра товара
├── actions.php                    # Страница акций
├── contacts.php                   # Страница контактов
├── guarantees.php                 # Страница гарантий
├── pay.php                        # Страница оплаты и доставки
├── service.php                    # Страница автосервиса
├── send_form.php                  # Обработчик форм обратной связи
├── getf.php                       # AJAX-обработчик фильтров каталога
├── getdtls.php                    # AJAX-обработчик автоподбора
├── seo_query.php                  # Страница SEO-запроса
├── seo_cluster.php                # Страница кластера SEO-запросов
├── sitemap.php                    # XML карта сайта
├── blog.php                       # Страница блога
├── blog_article.php               # Страница статьи блога
├── faq.php                        # Страница FAQ
├── adm.php                        # Административная панель
├── css.css                        # Основные стили
├── mob.css                        # Мобильные стили
├── tab.css                        # Стили для планшетов
├── robots.txt                     # Правила для поисковых роботов
└── 404.php                        # Страница 404
```

## Установка и запуск

### Требования

- PHP 7.4 или выше
- MySQL 5.7 или выше
- Apache с поддержкой mod_rewrite
- Расширения PHP:
  - mysqli
  - openssl
  - gd (для работы с изображениями)
  - mbstring (для работы с UTF-8)

### Установка

1. Клонируйте репозиторий или скопируйте файлы на веб-сервер:

```bash
git clone <repository-url>
cd mystic
```

2. Настройте базу данных:

Откройте файл `motor-land.kz/hyst/config.php` и укажите данные для подключения:

```php
define("DB_HOST", "localhost");
define("DB_USER", "your_username");
define("DB_PASSWORD", "your_password");
define("DB_BASE", "your_database");
define("SITE_MAIL", "robot@your-domain.kz");
define("SITE_URL", "http://your-domain.kz");
```

3. Настройте права доступа:

```bash
chmod 777 motor-land.kz/cms_img
chmod 755 motor-land.kz
```

4. Создайте необходимые таблицы базы данных:

Таблицы создаются автоматически при первом запуске через админ-панель. Основные таблицы:
- `hyst_escalibe` - пользователи административной панели
- `internet_magazin_tovari` - товары каталога
- `internet_magazin_category` - категории товаров
- `internet_magazin_atributs_options` - опции атрибутов (годы, характеристики)
- `page_content` - контент страниц
- `seo_queries` - SEO-запросы
- И другие модульные таблицы

5. Откройте сайт в браузере и перейдите в админ-панель по адресу `/adm.php`

6. При первом входе создайте администратора системы

### Конфигурация Apache

Настройте `.htaccess` для ЧПУ URL (если используется):

```apache
RewriteEngine On
RewriteBase /
RewriteRule ^catalog/?$ catalog.php [L]
RewriteRule ^contacts/?$ contacts.php [L]
RewriteRule ^pay/?$ pay.php [L]
RewriteRule ^service/?$ service.php [L]
RewriteRule ^guarantees/?$ guarantees.php [L]
RewriteRule ^actions/?$ actions.php [L]
RewriteRule ^katalog/([a-z0-9-]+)-(\d+)/?$ detal.php?id=$2 [L]
RewriteRule ^query/([a-z0-9-]+)/?$ seo_query.php?slug=$1 [L]
RewriteRule ^query-cluster/([^/]+)/?$ seo_cluster.php?cluster=$1 [L]
```

## База данных

### Основные таблицы

#### Товары
- `internet_magazin_tovari` - основная таблица товаров
  - `id` - ID товара
  - `name` - название товара
  - `category` - категории (марки) в формате [id1][id2]
  - `podegory` - подкатегории (модели) в формате [id1][id2]
  - `atributs_opt` - атрибуты (годы) в формате [id1][id2]
  - `text` - полное описание
  - `stext` - краткое описание
  - `tmeta` - мета-описание
  - `images` - изображения в формате [path1][path2]
  - `cash` - цена
  - `sale` - акция
  - `prio` - приоритет сортировки

#### Категории
- `internet_magazin_category` - категории товаров (марки и модели)
  - `id` - ID категории
  - `idp` - ID родительской категории ('noting' для марки)
  - `name` - название категории

#### Атрибуты
- `internet_magazin_atributs_options` - опции атрибутов (годы)
  - `id` - ID опции
  - `idp` - ID родителя (1 для годов)
  - `name` - название (год)

#### Контент страниц
- `page_content` - редактируемый контент страниц
  - `page_key` - ключ страницы (contacts_page, catalog_page и т.д.)
  - `h1_text` - H1 заголовок
  - `meta_title` - мета-заголовок
  - `meta_description` - мета-описание
  - `meta_keywords` - мета-ключевые слова
  - `content` - HTML контент

#### SEO-запросы
- `seo_queries` - SEO-запросы для создания целевых страниц
  - `slug` - URL slug
  - `query_text` - текст запроса
  - `cluster` - кластер запроса
  - `h1_text` - H1 заголовок
  - `meta_title` - мета-заголовок
  - `meta_description` - мета-описание
  - `content` - HTML контент
  - `priority` - приоритет
  - `is_active` - активность

## Основные возможности

### Для пользователей

- Просмотр каталога контрактных двигателей и КПП
- Фильтрация по марке, модели и году выпуска автомобиля
- Детальный просмотр товаров с описанием и характеристиками
- Просмотр акционных предложений
- Отправка заявок на консультацию и заказ товаров
- Просмотр контактной информации и гарантий
- Информация о доставке и оплате
- Информация об автосервисе

### Для администраторов

- Управление товарами (добавление, редактирование, удаление)
- Управление категориями и подкатегориями (марки и модели)
- Управление атрибутами (годы выпуска)
- Управление слайдерами на главной странице
- Управление текстовым контентом страниц
- Загрузка и управление изображениями
- Управление SEO-запросами и кластерами
- Управление модераторами системы
- Управление блогом и статьями

## Безопасность

В проекте реализованы следующие меры безопасности:

- **Prepared Statements:** Все SQL-запросы используют подготовленные запросы для предотвращения SQL-инъекций
- **Валидация данных:** Входные данные проверяются регулярными выражениями
- **Экранирование вывода:** Использование `htmlspecialchars()` для предотвращения XSS-атак
- **Защита от спама:** Honeypot поля, проверка времени отправки форм, фильтрация подозрительных паттернов
- **Сессии:** Использование сессий для авторизации администраторов
- **Хеширование паролей:** MD5 хеширование паролей администраторов

## SEO

### Реализованные возможности

- Мета-теги (title, description, keywords) для всех страниц
- Open Graph разметка для социальных сетей
- Twitter Cards
- Schema.org разметка (Organization, Product, LocalBusiness, BreadcrumbList, Service)
- XML Sitemap с автоматическим обновлением
- ЧПУ URL для товаров и SEO-запросов
- Оптимизация изображений (WebP с fallback)
- Семантическая HTML разметка
- Канонические URL
- Breadcrumbs навигация

### Структура URL

- Главная: `/`
- Каталог: `/catalog`
- Товар: `/katalog/product-name-123` или `/detal?id=123`
- Контакты: `/contacts`
- Оплата: `/pay`
- Сервис: `/service`
- Гарантии: `/guarantees`
- Акции: `/actions`
- SEO-запрос: `/query/slug`
- Кластер запросов: `/query-cluster/cluster-name`

## Производительность

- Оптимизированные SQL-запросы с использованием индексов
- Кеширование версий CSS/JS через параметр версии в URL
- Оптимизация изображений через функцию `get_optimized_image()` с поддержкой WebP
- Lazy loading для изображений
- Preload для критических ресурсов
- Минификация JavaScript для production

## Разработка

### Архитектура

Проект построен на собственной CMS-системе Hyst, которая обеспечивает модульную архитектуру:

- **Ядро системы** (`hyst/core/`) — базовые функции и классы
- **Модули** (`hyst/mods/`) — независимые функциональные модули
- **Визуальные компоненты** (`hyst/visual/`) — стили и скрипты админ-панели

### Работа с базой данных

Все запросы к базе данных выполняются через подготовленные запросы:

```php
$stmt = $_DB_CONECT->prepare("SELECT * FROM table WHERE id = ?");
$stmt->bind_param("i", $id);
$stmt->execute();
$result = $stmt->get_result();
```

### Добавление нового модуля

1. Создайте директорию в `hyst/mods/your_module/`
2. Создайте файл `info.ini` с метаинформацией модуля
3. Создайте файл `index.php` для административного интерфейса
4. Создайте файл `proces.php` для обработки AJAX-запросов

### Основные функции

- `get_page_content($page_key)` - получение контента страницы
- `get_optimized_image($image_path)` - получение оптимизированного изображения (WebP)
- `get_slider($slider_key)` - получение слайдера
- `get_simple_texts($key)` - получение простого текста
- `get_simple_images($key)` - получение изображений
- `get_customtexts($key)` - получение пользовательского текста
- `seo_get_product_url($id, $name)` - генерация ЧПУ URL для товара
- `hyst_test_id($value)` - проверка ID
- `htmlspecialchars()` - экранирование вывода

## Аналитика

Проект интегрирован с Google Analytics:
- Отслеживание конверсий при клике на телефон
- Отслеживание отправки форм
- События покупки товаров

## Контакты

- **Сайт:** https://motor-land.kz
- **Офис №1:** РВ-90, 7-линия, 29, Алматы
- **Офис №2:** улица Свердлова, 38, Алматы
- **Телефоны:** +7 777 144 5445, +7 701 144 5445, +7 707 144 5445

## Лицензия

Проект является коммерческим продуктом компании Motor Land.

---

**Версия:** 1.0  
**Последнее обновление:** 2025
